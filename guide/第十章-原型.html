<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Prototypes | JavaScript 心智💗模型</title>
    <meta name="description" content="Vite & Vue powered static site generator.">
    <link rel="stylesheet" href="/javascript-mental-models/assets/style.e6ac6c2e.css">
    <link rel="modulepreload" href="/javascript-mental-models/assets/chunks/AlgoliaSearchBox.1a37182a.js">
    <link rel="modulepreload" href="/javascript-mental-models/assets/app.c931d240.js">
    <link rel="modulepreload" href="/javascript-mental-models/assets/guide_第十章-原型.md.c9f47ca3.lean.js">
    
    <meta name="twitter:title" content="Prototypes | JavaScript 心智💗模型">
  <meta property="og:title" content="Prototypes | JavaScript 心智💗模型">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/javascript-mental-models/" aria-label="JavaScript 心智💗模型, back to home" data-v-675d8756 data-v-cc01ef16><!----> JavaScript 心智💗模型</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/javascript-mental-models/guide" data-v-b8818f8c>Start <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/sudongyuer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>About ME <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/sudongyuer/javascript-mental-models" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/javascript-mental-models/guide" data-v-b8818f8c>Start <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/sudongyuer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>About ME <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/sudongyuer/javascript-mental-models" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">开始探索我们的JavaScript宇宙吧🌈</p><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第一章-心智模型">第一章-什么是心智模型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第二章-JavaScript宇宙">第二章-JavaScript宇宙</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第三章-值与变量">第三章-值与变量</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第四章-从内部学习">第四章-从内部学习</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第五章-会见原始值">第五章-会见原始值</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第六章-会见对象与函数">第六章-会见对象与函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第七章-平等的价值">第七章-平等的价值</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第八章-Properties(属性)">第八章-Properties(属性)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/javascript-mental-models/guide/第九章-突变">第九章-突变</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/javascript-mental-models/guide/第十章-原型">第十章-原型</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#prototypes-1">Prototypes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#原型在行动">原型在行动</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#prototype-chain（原型链）">Prototype Chain（原型链）</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#shadowing-遮蔽">Shadowing 遮蔽</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#assignment">Assignment</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#object原型">Object原型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#没有原型的对象">没有原型的对象</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#原型污染">原型污染</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#有趣的事实">有趣的事实</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#回顾">回顾</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="prototypes" tabindex="-1">Prototypes <a class="header-anchor" href="#prototypes" aria-hidden="true">#</a></h1><blockquote><p>在之前的模块中，我们已经讨论了对象属性和变异，但是还没有完全完成——我们仍然需要讨论原型!</p></blockquote><p>这里有一个小谜语来检验我们的心智模式</p><div class="language-js"><pre><code><span class="token keyword">let</span> pizza <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pizza<span class="token punctuation">.</span>taste<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;pineapple&quot;</span>
</code></pre></div><p>问问你自己:这可能吗?</p><p>我们只是用<code>{}</code>创建了一个空对象。在<code>log</code>之前，我们肯定没有给它设置任何属性，所以看起来pizza.taste不能指向 &quot;pineapple&quot;。我们会期望pizza.taste给我们的是<code>undefined</code>，而不是当一个属性不存在的时候，我们通常会得到undefined，对吗？</p><p>然而，pizza.taste有可能是 <code>pineapple</code>！这可能是一个伪造的例子。这可能是一个矫揉造作的例子，但它表明我们的心理模型是不完整的。</p><p>在这个模块中，我们将介绍原型。原型解释了这个谜题中发生的事情，更重要的是，它是其他几个基本JavaScript特性的核心。偶尔人们会忽略对原型的学习，因为它们看起来太不寻常了，但其核心思想是非常简单的。</p><h2 id="prototypes-1" tabindex="-1">Prototypes <a class="header-anchor" href="#prototypes-1" aria-hidden="true">#</a></h2><p>这里有两个变量指向两个对象</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以用熟悉的方式来表示它们</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1cvc0iyu0j211s0ga0tl.jpg" alt=""></p><p>在此例, <code>gwen</code> 指向一个没有 <code>teeth</code> 属性的对象.根据我们学过的规则，这个属性可以得到<code>undefined</code></p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>但故事不会就此结束。JavaScript的默认行为返回<code>undefined</code>，但我们可以指示它继续在另一个对象上搜索丢失的属性。我们可以用一行代码来完成</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// We added this line:</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>那个神秘的<code>__proto__</code>属性是什么?</p><p>它代表了JavaScript原型的概念。任何JavaScript对象都可以选择另一个对象作为原型。我们将讨论这在实践中意味着什么，但现在，让我们把它看作一个特殊的<code>__proto__</code>导线</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1cvgaz35sj21240kcjsq.jpg" alt=""></p><p>花点时间来验证图表与代码是否匹配。我们画的和以前一样。唯一的新东西是神秘的<code>__proto__</code>电线。 通过指定<code>__proto__</code>(也被称为对象的原型)，我们指示JavaScript继续寻找该对象上缺失的属性。</p><h2 id="原型在行动" tabindex="-1">原型在行动 <a class="header-anchor" href="#原型在行动" aria-hidden="true">#</a></h2><p>我们去找<code>gwen.teeth</code>时，我们得到了<code>undefined</code>因为<code>teeth</code>属性在<code>Gwen</code>指向的对象上不存在。 但是由于<code>__proto__: human</code>，答案是不同的:</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// &quot;Look for other properties here&quot;</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>
</code></pre></div><ul><li>JS宇宙会去查找<code>gwen</code>导线找到指向的对象</li><li>然后询问对象上是否有<code>teeth</code>属性 <ul><li>得到没有的答案</li><li>但是有一个原型属性，你可以去找找看</li></ul></li><li>于是就继续去原型属性指向的对象查找<code>teeth</code>属性 <ul><li>是的，找到了teeth属性指向32</li><li>所以 <code>gwen.teeth</code>的结果是32</li></ul></li></ul><p>这类似于说，“我不知道，但<code>XXX</code>可能知道。使用<code>__proto__</code>，你指示JavaScript询问另一个对象</p><p>为了检查你到目前为止的理解，写下你的答案:</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
</code></pre></div><p>答案如下</p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 19</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>上面的例子提醒了我们，<code>gwen.teeth</code>只是一个表达——一个对我们JavaScript世界的问题——JavaScript将遵循一系列步骤来回答它。现在我们知道这些步骤包括查看原型。</p><h2 id="prototype-chain（原型链）" tabindex="-1">Prototype Chain（原型链） <a class="header-anchor" href="#prototype-chain（原型链）" aria-hidden="true">#</a></h2><blockquote><p>原型在JavaScript中并不是一个特殊的“东西”。原型更像是一种关系。一个对象可以指向另一个对象作为它的原型。 这自然会引出一个问题:但是如果我的对象的原型有它自己的原型呢?那个原型有自己的原型吗?会工作吗? 答案是肯定的——这就是它的工作原理!</p></blockquote><div class="language-js"><pre><code><span class="token keyword">let</span> mammal <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">brainy</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> mammal<span class="token punctuation">,</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>brainy<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>我们可以看到JavaScript将在对象上搜索属性，然后在对象的原型上搜索属性，然后在对象的原型上搜索属性，以此类推。如果我们没有原型，也没有找到我们的属性，我们就得到<code>undefined</code>。</p><p>这类似于说，“我不知道，但爱丽丝可能知道。”然后爱丽丝可能会说:“实际上，我也不知道——问鲍勃吧。”最终，你要么找到答案，要么找不到人问了! 这个要“访问”的对象序列被称为我们的对象原型链。(然而，与你可能佩戴的链条不同，原型链条不可能是圆形的!)</p><h2 id="shadowing-遮蔽" tabindex="-1">Shadowing 遮蔽 <a class="header-anchor" href="#shadowing-遮蔽" aria-hidden="true">#</a></h2><p>考虑一下这个稍微修改过的例子</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token comment">// This object has its own teeth property:</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">31</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 31</span>
</code></pre></div><p>注意,<code>gwen.teen</code>是31。如果gwen没有自己的牙齿属性，我们会看看原型。但是因为gwen指向的对象有它自己的teeth属性，我们不需要继续寻找答案</p><p>换句话说，一旦找到我们的属性，我们就停止搜索。</p><p>如果你想要检查一个对象是否有它自己的属性线与特定的名称，你可以调用一个内置的函数<code>hasOwnProperty</code>。对于“own”属性，它返回true，而不查看原型。在我们的最后一个例子中，两个对象都有自己的牙齿线，所以这对两个都是正确的</p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">&#39;teeth&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">&#39;teeth&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="assignment" tabindex="-1">Assignment <a class="header-anchor" href="#assignment" aria-hidden="true">#</a></h2><p>考虑一下这个例子</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> gwen <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> human<span class="token punctuation">,</span>
  <span class="token comment">// Note: no own teeth property</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


gwen<span class="token punctuation">.</span>teeth <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
</code></pre></div><p>答案如下</p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gwen<span class="token punctuation">.</span>teeth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 31</span>
</code></pre></div><p>当我们<em>读取</em>对象上不存在的属性时，我们将继续在原型链上查找它。如果我们没有找到它，我们会得到<code>undefined</code>.</p><p>但是当我们<em>编写</em>一个在我们的对象上不存在的属性时，它会在我们的对象上<em>创建</em>该属性。一般来说，原型<em>不会</em>发挥作用。</p><h2 id="object原型" tabindex="-1">Object原型 <a class="header-anchor" href="#object原型" aria-hidden="true">#</a></h2><p>这个对象没有原型，对吧?</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在浏览器打印一下</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//玩一下</span>
</code></pre></div><p>令人惊讶的是,<code>obj.__proto__</code>不是<code>null</code>或<code>undefined</code>!相反，您将看到一个奇怪的对象，它有一堆属性，包括<code>hasOwnProperty</code></p><p>我们将这个特殊对象称为<code>Object Prototype</code></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1cw33bc5oj212o0qe40u.jpg" alt=""></p><p>一直以来，我们都认为{}创建了一个<code>空</code>对象，但它毕竟不是那么空!它有一个隐藏的<code>__proto__</code>线，默认情况下指向<code>对象原型</code>。 这就解释了为什么JavaScript对象似乎有“内置”属性:</p><div class="language-js"><pre><code><span class="token keyword">let</span> human <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">teeth</span><span class="token operator">:</span> <span class="token number">32</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (function)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>human<span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// // (function)</span>
</code></pre></div><p>这些<code>内置</code>属性只不过是对象原型上的普通属性。因为我们的对象原型是object prototype，所以我们可以访问它们。</p><h2 id="没有原型的对象" tabindex="-1">没有原型的对象 <a class="header-anchor" href="#没有原型的对象" aria-hidden="true">#</a></h2><p>我们刚刚了解到，所有使用<code>{}</code>语法创建的对象都有特殊的<code>__proto__</code>导线指向一个默认的<code>对象原型</code>。但是我们也知道我们可以自定义<code>__proto__</code>你可能会想:我们能把它设为<code>null</code>吗?</p><div class="language-js"><pre><code><span class="token keyword">let</span> weirdo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>当然可以</p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weirdo<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weirdo<span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>你可能不想创建这样的对象，但是对象原型正是这样的——一个没有原型的对象。</p><h2 id="原型污染" tabindex="-1">原型污染 <a class="header-anchor" href="#原型污染" aria-hidden="true">#</a></h2><p>现在我们知道，所有JavaScript对象默认情况下都有相同的原型。让我们简要地回顾一下关于突变模块的例子:</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1cw98aid5j213j0u00v1.jpg" alt=""></p><p>这幅图给了我们一个有趣的见解。如果JavaScript在原型中搜索丢失的属性，而大多数对象都共享相同的原型，那么我们是否可以通过改变原型使新属性“出现”在所有对象上?</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>smell <span class="token operator">=</span> <span class="token string">&#39;banana&#39;</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js"><pre><code>nsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sherlock<span class="token punctuation">.</span>smell<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;banana&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>watson<span class="token punctuation">.</span>smell<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;banana&quot;</span>
</code></pre></div><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1cwa26wzgj20zd0u0go6.jpg" alt=""></p><ul><li>像我们刚才做的那样，改变一个共享的原型叫做原型污染。</li><li>在过去，原型污染是自定义特性扩展JavaScript的一种流行方式。</li><li>然而，多年来，网络社区意识到它是脆弱的，很难添加新的语言特性，所以我们宁愿避免它</li></ul><h3 id="有趣的事实" tabindex="-1">有趣的事实 <a class="header-anchor" href="#有趣的事实" aria-hidden="true">#</a></h3><p>在JavaScript添加类之前，通常是将它们编写为生成对象的函数，例如:</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">shape</span><span class="token operator">:</span> <span class="token string">&#39;round&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> donutProto <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Nom nom nom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> donut1 <span class="token operator">=</span> <span class="token function">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
donut1<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> donutProto<span class="token punctuation">;</span>
<span class="token keyword">let</span> donut2 <span class="token operator">=</span> <span class="token function">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
donut2<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> donutProto<span class="token punctuation">;</span>

donut1<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
donut2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这就是为什么JavaScript有一个<code>new</code>的关键字。当您将<code>new</code>关键字放在Donut()函数调用之前时，会发生两件事</p><ul><li>该对象是自动创建的，所以您不需要从Donut返回它。(可以这样使用。)</li><li>该对象的<code>__proto__</code>将被设置为你放入函数的prototype属性中的任何值。</li></ul><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>shape <span class="token operator">=</span> <span class="token string">&#39;round&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Donut</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Nom nom nom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> donut1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// __proto__: Donut.prototype</span>
<span class="token keyword">let</span> donut2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Donut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// __proto__: Donut.prototype</span>


donut1<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
donut2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>ES6 Class</strong></p><p>Class.js</p><div class="language-js"><pre><code><span class="token keyword">class</span> <span class="token class-name">Spiderman</span> <span class="token punctuation">{</span>
  <span class="token function">lookOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;My Spider-Sense is tingling.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> miles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Spiderman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
miles<span class="token punctuation">.</span><span class="token function">lookOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Prototypes.js</p><div class="language-js"><pre><code><span class="token comment">// class Spiderman {</span>
<span class="token keyword">let</span> SpidermanPrototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">lookOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;My Spider-Sense is tingling.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// let miles = new Spiderman();</span>
<span class="token keyword">let</span> miles <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">__proto__</span><span class="token operator">:</span> SpidermanPrototype <span class="token punctuation">}</span><span class="token punctuation">;</span>
miles<span class="token punctuation">.</span><span class="token function">lookOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="回顾" tabindex="-1">回顾 <a class="header-anchor" href="#回顾" aria-hidden="true">#</a></h2><ul><li>读取时<code>obj.something</code>，如果<code>obj</code>没有<code>something</code>属性，JavaScript 会查找<code>obj.__proto__.something</code>. 然后它会寻找<code>obj.__proto__.__proto__.something</code>，依此类推，直到找到我们的属性或到达原型链的末端。</li><li>写入时<code>obj.something</code>，JavaScript 通常会直接写入对象，而不是遍历原型链。</li><li>我们可以使用它<code>obj.hasOwnProperty(&#39;something&#39;)</code>来确定我们的对象是否有<em>自己的</em>属性，称为<code>something</code>.</li><li>我们可以通过变异来“污染”许多对象共享的原型。我们甚至可以对对象原型（对象的默认原型）执行此操作<code>{}</code>！（但我们不应该这样做，除非我们在恶作剧我们的同事。）</li><li>在实践中，您可能不会直接使用原型。但是，它们是 JavaScript 对象的基础，因此理解它们的底层机制很方便。一些高级的 JavaScript 特性，包括类，可以用原型来表达。</li></ul></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><p class="last-updated" data-v-07c132fc data-v-abce3432><span class="prefix" data-v-abce3432>Last Updated:</span><span class="datetime" data-v-abce3432></span></p></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/javascript-mental-models/guide/第九章-突变" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>第九章-突变</span></a></div><div class="next" data-v-38ede35f><!----></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"guide_第一章-心智模型.md\":\"d2ed539c\",\"guide_第七章-平等的价值.md\":\"4a93fb7c\",\"guide_第三章-值与变量.md\":\"4e30e4fc\",\"guide_第九章-突变.md\":\"8e968c04\",\"guide_第二章-javascript宇宙.md\":\"b86c7542\",\"guide_第五章-会见原始值.md\":\"3feac74d\",\"guide_第八章-properties(属性).md\":\"d894c02f\",\"guide_第六章-会见对象与函数.md\":\"47adce98\",\"guide_第十章-原型.md\":\"c9f47ca3\",\"guide_第四章-从内部学习.md\":\"1b0af384\",\"index.md\":\"2158b8fd\"}")</script>
    <script type="module" async src="/javascript-mental-models/assets/app.c931d240.js"></script>
    
  </body>
</html>